<div class="container">
  <div class="card">
    <header>
      <div class="header-row">
        <div>
          <h1>Thông tin Manager</h1>
          <p>Xem chi tiết thông tin quản lý viên</p>
        </div>
        <div class="header-actions">
          <a [routerLink]="['/admin/manager/edit', managerId]" class="btn-primary" *ngIf="manager">
            <svg class="btn-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
            </svg>
            Chỉnh sửa
          </a>
          <a routerLink="/admin/manager/list" class="btn-secondary">
            <svg class="btn-icon" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
            </svg>
            Quay lại
          </a>
        </div>
      </div>
    </header>

    <div *ngIf="errorMessage" class="alert-error">
      <strong>Lỗi!</strong> {{ errorMessage }}
      <button class="alert-close" (click)="errorMessage = ''">×</button>
    </div>

    <div *ngIf="loading" class="loading-container">
      <div class="spinner"></div>
      <p>Đang tải thông tin...</p>
    </div>

    <div *ngIf="!loading && manager" class="profile-content">
      <!-- Profile Header -->
      <section class="profile-panel">
        <div class="profile-panel__avatar">
          <img
            [src]="getAvatarUrl()"
            alt="Ảnh đại diện"
            class="avatar-image" />
        </div>
        <div class="profile-panel__meta">
          <div class="meta-chip" [ngClass]="getStatusClass()">
            {{ manager.status || 'Chưa thiết lập' }}
          </div>
          <div class="meta-grid">
            <div class="meta-card">
              <span class="meta-label">Email</span>
              <strong>{{ manager.email || 'Chưa có' }}</strong>
            </div>
            <div class="meta-card">
              <span class="meta-label">Số điện thoại</span>
              <strong>{{ manager.phone || 'Chưa có' }}</strong>
            </div>
            <div class="meta-card">
              <span class="meta-label">Last login</span>
              <strong>{{ formatDate(manager.lastLoginAt) }}</strong>
            </div>
            <div class="meta-card">
              <span class="meta-label">Building phụ trách</span>
              <strong>{{ manager.assignedBuildings ? manager.assignedBuildings.length : 0 }}</strong>
            </div>
          </div>
        </div>
      </section>

      <!-- Basic Information -->
      <section class="info-section">
        <div class="section-header">
          <h2>Thông tin cơ bản</h2>
        </div>
        <div class="info-grid">
          <div class="info-item">
            <span class="info-label">Họ tên</span>
            <span class="info-value">{{ manager.name || 'Chưa có' }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">Mã nhân viên</span>
            <span class="info-value">{{ manager.staffCode || 'Chưa có' }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">Email</span>
            <span class="info-value">{{ manager.email || 'Chưa có' }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">Số điện thoại</span>
            <span class="info-value">{{ manager.phone || 'Chưa có' }}</span>
          </div>
          <div class="info-item">
            <span class="info-label">Trạng thái</span>
            <span class="info-value" [ngClass]="getStatusClass()">
              {{ manager.status || 'Chưa thiết lập' }}
            </span>
          </div>
          <div class="info-item">
            <span class="info-label">Vai trò</span>
            <span class="info-value">{{ manager.role || 'Chưa có' }}</span>
          </div>
        </div>
      </section>

      <!-- Assigned Buildings -->
      <section class="info-section" *ngIf="manager.assignedBuildings && manager.assignedBuildings.length > 0">
        <div class="section-header">
          <h2>Toà nhà phụ trách</h2>
          <p class="section-subtitle">{{ manager.assignedBuildings.length }} toà nhà</p>
        </div>
        <div class="building-grid">
          <div
            class="building-card"
            *ngFor="let building of manager.assignedBuildings">
            <div class="building-card__header">
              <h3>{{ building.buildingName || 'Chưa đặt tên' }}</h3>
              <span class="building-code">{{ building.buildingCode }}</span>
            </div>
            <div class="building-card__status" [ngClass]="{'status-active': building.isActive, 'status-inactive': !building.isActive}">
              {{ building.isActive ? 'Đang hoạt động' : 'Không hoạt động' }}
            </div>
          </div>
        </div>
      </section>

      <div *ngIf="!manager.assignedBuildings || manager.assignedBuildings.length === 0" class="info-section">
        <div class="section-header">
          <h2>Toà nhà phụ trách</h2>
        </div>
        <div class="empty-state">
          <p>Chưa được gán quản lý toà nhà nào.</p>
        </div>
      </div>
    </div>
  </div>
</div>

