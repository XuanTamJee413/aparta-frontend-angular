<div class="container">
  <div class="card">
    <header>
      <h1>Thêm mới Tòa nhà</h1>
      <p>Nhập thông tin cấu trúc và vận hành cho tòa nhà mới</p>
    </header>

    <div *ngIf="errorMessage" class="alert alert-danger mt-3">{{ errorMessage }}</div>
    <div *ngIf="successMessage" class="alert alert-success mt-3">{{ successMessage }}</div>

    <form [formGroup]="createForm" (ngSubmit)="onSubmit()" class="mt-4">
      
      <h5 class="mb-3 text-primary border-bottom pb-2">Thông tin chung</h5>
      <div class="row">
        <div class="col-md-6 mb-3">
          <label class="form-label fw-bold">Dự án <span class="text-danger">*</span></label>
          <select class="form-control" formControlName="projectId">
            <option value="">-- Chọn Dự án --</option>
            <option *ngFor="let p of projects" [value]="p.projectId">{{ p.name }} ({{p.projectCode}})</option>
          </select>
          <small *ngIf="createForm.get('projectId')?.invalid && createForm.get('projectId')?.touched" class="text-danger">
            Vui lòng chọn dự án.
          </small>
        </div>
        <div class="col-md-6 mb-3">
          <label class="form-label fw-bold">Mã tòa nhà <span class="text-danger">*</span></label>
          <input type="text" class="form-control" formControlName="buildingCode" placeholder="VD: TOA_A (Chữ hoa, không dấu)">
          <small class="text-muted">Chỉ dùng chữ hoa (A-Z), số (0-9) và gạch dưới (_)</small>
          <div *ngIf="createForm.get('buildingCode')?.invalid && createForm.get('buildingCode')?.touched" class="text-danger small">
            Mã không hợp lệ.
          </div>
        </div>
        <div class="col-12 mb-3">
          <label class="form-label fw-bold">Tên hiển thị <span class="text-danger">*</span></label>
          <input type="text" class="form-control" formControlName="name" placeholder="VD: Tòa Park 1">
        </div>
      </div>

      <h5 class="mb-3 mt-4 text-primary border-bottom pb-2">Cấu trúc & Kỹ thuật</h5>
      <div class="row">
        <div class="col-md-3 mb-3">
          <label class="form-label">Số tầng nổi <span class="text-danger">*</span></label>
          <input type="number" class="form-control" formControlName="totalFloors" min="1">
        </div>
        <div class="col-md-3 mb-3">
          <label class="form-label">Số tầng hầm <span class="text-danger">*</span></label>
          <input type="number" class="form-control" formControlName="totalBasements" min="0">
        </div>
        <div class="col-md-3 mb-3">
          <label class="form-label">Tổng diện tích (m²)</label>
          <input type="number" class="form-control" formControlName="totalArea">
        </div>
        <div class="col-md-3 mb-3">
          <label class="form-label">Ngày bàn giao</label>
          <input type="date" class="form-control" formControlName="handoverDate">
        </div>
      </div>

      <h5 class="mb-3 mt-4 text-primary border-bottom pb-2">Vận hành</h5>
      <div class="row">
        <div class="col-md-6 mb-3">
          <label class="form-label">Hotline Sảnh Lễ tân</label>
          <input type="text" class="form-control" formControlName="receptionPhone" placeholder="VD: 024...">
        </div>
        <div class="col-md-3 mb-3">
          <label class="form-label">Ngày chốt số (Từ) <span class="text-danger">*</span></label>
          <input type="number" class="form-control" formControlName="readingWindowStart" min="1" max="31">
        </div>
        <div class="col-md-3 mb-3">
          <label class="form-label">Đến ngày <span class="text-danger">*</span></label>
          <input type="number" class="form-control" formControlName="readingWindowEnd" min="1" max="31">
        </div>
        <div class="col-12 mb-3">
          <label class="form-label">Mô tả / Ghi chú</label>
          <textarea class="form-control" formControlName="description" rows="3"></textarea>
        </div>
      </div>

      <div class="d-flex justify-content-end gap-2 mt-4 pt-3 border-top">
        <a routerLink="/admin/building/list" class="btn btn-secondary">Hủy bỏ</a>
        <button type="submit" class="btn btn-primary" [disabled]="isSubmitting">
          {{ isSubmitting ? 'Đang lưu...' : 'Lưu Tòa Nhà' }}
        </button>
      </div>
    </form>
  </div>
</div>