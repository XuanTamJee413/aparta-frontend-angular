<div class="contract-detail-wrapper">
  <div class="breadcrumb">
    <a routerLink="/manager/manage-contract">Danh sách hợp đồng</a>
    <span>/</span>
    <span>Cập nhật hợp đồng</span>
  </div>

  <div *ngIf="isLoading" class="state state-loading">
    Đang tải thông tin hợp đồng...
  </div>

  <div *ngIf="!isLoading && errorMessage" class="state state-error">
    {{ errorMessage }}
  </div>

  <form
    *ngIf="!isLoading && !errorMessage && contract && form"
    [formGroup]="form"
    class="card"
    (ngSubmit)="onSubmit()"
  >
    <div class="card-header">
      <div>
        <h1>Cập nhật hợp đồng thuê căn hộ</h1>
        <p class="subtitle">
          Mã hợp đồng:
          <strong>{{ contract.contractId }}</strong>
        </p>
        <p class="subtitle">
          Căn hộ:
          <strong>{{ contract.apartmentCode || contract.apartmentId }}</strong>
        </p>
      </div>

      <!-- <div class="actions">
        <a
          *ngIf="pdfUrl"
          [href]="pdfUrl"
          target="_blank"
          rel="noopener"
          class="btn btn-outline"
        >
          Tải PDF
        </a>
      </div> -->
    </div>

    <div class="card-body">
      <div class="section-title">Thông tin người thuê</div>

      <div class="row">
        <div class="label">Người thuê (Chủ hộ)</div>
        <div class="value">{{ contract.ownerName || '—' }}</div>
      </div>

      <div class="row">
        <div class="label">Số điện thoại</div>
        <div class="value">{{ contract.ownerPhoneNumber || '—' }}</div>
      </div>

      <div class="row">
        <div class="label">Email</div>
        <div class="value">{{ contract.ownerEmail || '—' }}</div>
      </div>

      <div class="section-title">Thời hạn hợp đồng</div>

      <div class="row">
        <div class="label">Ngày bắt đầu</div>
        <div class="value">
          {{ formatDate(contract.startDate) }}
        </div>
      </div>

      <div class="row">
        <div class="label">Ngày kết thúc</div>
        <div class="value">
          <input
            type="date"
            class="input-control"
            formControlName="endDate"
          />
        </div>
      </div>

      <div class="row">
        <div class="label">Ngày tạo hợp đồng</div>
        <div class="value">
          {{ formatDate(contract.createdAt) }}
        </div>
      </div>

      <div class="section-title">Tệp đính kèm</div>

      <div class="row">
        <div class="label">Tải hình / scan hợp đồng</div>
        <div class="value value-column">
          <input
            type="file"
            class="input-control"
            accept="image/*,.pdf"
            (change)="onFileSelected($event)"
          />

          <div class="file-info" *ngIf="selectedFileName">
            Đã chọn: <strong>{{ selectedFileName }}</strong>
          </div>

          <a
            *ngIf="previewUrl"
            [href]="previewUrl"
            target="_blank"
            rel="noopener"
            class="preview-link"
          >
            Xem tệp hiện tại
          </a>
        </div>
      </div>
    </div>

    <div class="card-footer">
      <button
        type="button"
        class="btn btn-secondary"
        (click)="onCancel()"
        [disabled]="isSaving"
      >
        Hủy
      </button>

      <button
        type="submit"
        class="btn btn-primary"
        [disabled]="isSaving"
      >
        {{ isSaving ? 'Đang lưu...' : 'Lưu thay đổi' }}
      </button>
    </div>
  </form>
</div>
