<div class="invoice-list-wrapper">
  <h1 class="invoice-title">Danh sách hóa đơn</h1>

  <!-- Filters -->
  <div class="filters-container">
    <div class="filter-row">
      <div class="filter-group">
        <label for="status">Trạng thái:</label>
        <select id="status" [(ngModel)]="status" (change)="onStatusChange()" class="filter-input">
          <option *ngFor="let opt of statusOptions" [value]="opt.value">{{ opt.label }}</option>
        </select>
      </div>

      <div class="filter-group">
        <label for="apartmentCode">Mã căn hộ:</label>
        <div class="input-with-clear">
          <input type="text" id="apartmentCode" [(ngModel)]="apartmentCode" 
                 (input)="onApartmentCodeInput()" 
                 placeholder="Nhập mã căn hộ..."
                 class="filter-input" />
          <button *ngIf="apartmentCode" type="button" (click)="onClearApartmentCode()" class="clear-btn" title="Xóa">×</button>
        </div>
      </div>

      <div class="filter-group">
        <label for="billingPeriod">Kỳ thanh toán:</label>
        <div class="input-with-clear">
          <input type="month" id="billingPeriod" [(ngModel)]="billingPeriod" 
                 (change)="onBillingPeriodChange()" 
                 class="filter-input month-picker" />
          <button *ngIf="billingPeriod" type="button" (click)="onClearBillingPeriod()" class="clear-btn" title="Xóa">×</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Error Message -->
  <div *ngIf="error" class="alert-error">{{ error }}</div>

  <!-- Loading -->
  <div *ngIf="loading" class="loading-message">
    <div class="spinner"></div>
    <p>Đang tải dữ liệu...</p>
  </div>

  <!-- Invoice Table -->
  <div *ngIf="!loading && !error" class="table-container">
    <table class="invoice-table">
      <thead>
        <tr>
          <th>Mã HĐ</th>
          <th>Mã căn hộ</th>
          <th>Cư dân</th>
          <th>Kỳ thanh toán</th>
          <th>Ngày phát hành</th>
          <th>Ngày đến hạn</th>
          <th>Tổng tiền</th>
          <th>Đã thanh toán</th>
          <th>Trạng thái</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let invoice of invoices" class="invoice-row">
          <td class="invoice-number">{{ invoice.invoiceId }}</td>
          <td>{{ invoice.apartmentCode }}</td>
          <td>{{ invoice.residentName || '-' }}</td>
          <td>{{ getBillingPeriod(invoice.startDate, invoice.endDate) }}</td>
          <td>{{ formatDate(invoice.createdAt) }}</td>
          <td>{{ formatDate(invoice.endDate) }}</td>
          <td class="amount">{{ formatCurrency(invoice.price) }}</td>
          <td class="amount">{{ invoice.status === 'PAID' ? formatCurrency(invoice.price) : formatCurrency(0) }}</td>
          <td>
            <span class="status-badge" [ngClass]="getStatusClass(invoice.status)">
              {{ getStatusLabel(invoice.status) }}
            </span>
          </td>
        </tr>
        <tr *ngIf="invoices.length === 0 && !loading">
          <td colspan="9" class="no-data">Không có dữ liệu</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

